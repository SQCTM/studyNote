# 同源策略

[TOC]

## 浏览器安全

- **Web页面安全**
- **浏览器网络安全**
- **浏览器系统安全**



## 同源主要表现

如果两个URL的协议、域名和端口都相同，则这两个URL同源。浏览器默认两个相同的源之间可以相互访问资源或操作DOM，这之间有一套基础的安全策略的制约，即同源策略。同源策略是页面中最基础、最核心的安全策略

- **DOM层面**

  同源策略限制了来自不同源的JS脚本对当前DOM对象的读和写操作

- **数据层面**

  同源策略限制了不同源的站点读取当前站点的Cookie、IndexDB、LocalStorage等数据

- **网络层面**

  同源策略限制了通过XMLHttpRequest等方式将站点的数据发送给不同源的站点



## 安全和便利性的权衡

- **页面中可以嵌入第三方资源**

  安全问题最典型的有XSS攻击和CSRF攻击，为了解决XSS攻击，浏览器中引入了内容安全策略，称为**CSP**。CSP的核心思想是让服务器决定浏览器能够加载哪些资源，让服务器决定浏览器是否能够执行内联JS代码。这样可以大大减少XSS攻击

- **跨域资源共享和跨文档消息机制**

  - **跨资源共享**（CORS）机制可以进行跨域访问控制，从而使跨域数据传输得以安全进行
  - **跨文档消息机制**可以通过window.postMessage的JS接口来和不同源的DOM进行通信