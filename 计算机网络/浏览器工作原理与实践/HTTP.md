# HTTP

[TOC]

HTTP是浏览器中最重要且使用最多的协议，是浏览器和服务器之间的通信语言



## HTTP/0.9

用来在网络之间传递HTML超文本的内容，所以被称为**超文本传输协议**。它采用了基于请求响应的模式，从客户端发出请求，服务器返回数据

- **请求流程**
  1. 客户端先根据IP地址、端口和服务器建立TCP连接，而建立连接的过程就是TCP协议三次握手的过程
  2. 建立好连接之后，会发送一个GET请求行的信息
  3. 服务器接受请求信息之后，读取对应HTML文件，并将数据以ASCII字符流返回给客户端
  4. HTML文档传输完成后，断开连接
- **实现的特点**
  - 只有一个请求行，没有HTTP请求头和请求体，只需要一个请求行就可以完整表达客户端的需求
  - 服务器没有返回头信息，因为服务器端并不需要告诉客户端太多信息，只需要返回数据就可以了
  - 返回的文件内容是以ASCII字符流来传输的，因为都是HTML格式的文件，所以使用ASCII字节码来传输是最合适的



## HTTP/1.0

**支持多种类型的文件下载**是HTTP/1.0的核心诉求，文件格式不仅仅局限于ASCII编码，还有很多其他类型编码的文件

- **下载多种类型文件的实现**

  HTTP/1.0引入了请求头和响应头，都是以Key-Value形式保存，在HTTP发送请求时会带上请求头信息，服务器返回数据时，会先返回响应头信息

- **通过请求头和响应头来支持多种不同类型的数据**

  - **解决的问题**
    - 让浏览器知道服务器返回的数据是什么类型，于是浏览器能根据不同数据类型做针对性的处理
    - 浏览器可以告诉服务器它想要的语言版本页面，服务器可以对不同地区提供不同的语言版本，提供了国际化的支持
    - 浏览器可以知道文件的编码类型，能够准确地读取文件
  - **新增的特性**
    - 引入了**状态码**，状态码通过响应行的方式来通知浏览器的，告诉浏览器了服务器最终处理该请求的情况
    - 提供了**Cache机制**，用来缓存已经下载过的数据，减轻了服务器的压力
    - 在请求头的中加入了**用户代理**的字段，可以让服务器统计客户端的基础信息



## HTTP/1.1

- **改进**

  - **持久连接**

    - **问题**

      每进行一次HTTP通信都要经历建立TCP连接、传输HTTP数据和断开TCP连接三个阶段，如果在下载每个文件时都要经历这些步骤会增加大量无谓的开销

    - **解决**

      HTTP/1.1中增加了持久连接的方法，在一个TCP连接上可以传输多个HTTP请求，只要浏览器或服务器没有明确断开连接该TCP连接就会一直保持

  - **不成熟的HTTP管线化**

    - **问题**

      持久连接虽然能减少TCP的建立和断开次数，但它需要等待前面的请求返回之后才能进行下一次请求，若TCP通道中某个请求因为某些原因没有及时返回，那么会阻塞后面所有的请求，即**队头阻塞**

    - **解决**

      HTTP/1.1通过**管线化**来解决队头阻塞问题，管线化指将多个HTTP请求整批提交给服务器的技术，虽然可以整批发送请求，不过服务器依然需要根据请求顺序来回复浏览器的请求

      *一些浏览器都做过管线化的试验但最终都放弃了该技术

  - **提供虚拟主机的支持**

    - **问题**

      在HTTP/1.0中每个域名绑定了一个唯一的IP地址，因此一个服务器只能支持一个域名。但随着虚拟主机技术的发展，需要实现在一台物理主机上绑定多个虚拟主机，每个虚拟主机都有自己家的单独域名，这些单独域名都共用同一个IP地址

    - **解决**

      HTTP/1.1的请求头中增加了**Host字段**，用来表示当前的域名地址，这样服务器就可以根据不同的Host值做不同的处理

  - **对动态生成的内容提供了完美的支持**

    - **问题**

      HTTP/1.0需要在响应头中设置完整数据大小这样浏览器可以据此来接收数据，但很多页面的内容是动态生成，在传输数据前并不知道最终的数据大小，导致浏览器不知道何时会接收完所有文件数据

    - **解决**

      引入**Chunk transfer机制**来解决这个问题，服务器会将数据分割成若干个任意大小的数据块，每个数据块发送时会附上上个数据块的长度，最后使用一个零长度的块作为发送数据完成的标志，这样就提供了对动态内容的支持

  - **引入客户端Cookie、安全机制**

    

## HTTP/2.0





## HTTP/3.0