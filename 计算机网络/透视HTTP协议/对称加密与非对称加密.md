# 对称加密与非对称加密

[TOC]

## 加密算法

- **加密**：把明文转换成乱码变成密文的过程

- **解密**：使用密钥将密文还原成明文的过程，是加密的反操作

- 加密解密的操作过程就是**加密算法**

- **密钥**

  - 所有加密算法是公开的，但算法使用的密钥必须保密。由于HTTPS、TLS都运行在计算机上，所以密钥就是一长串数字，约定俗成的度量单位是**位**

  - 按照密钥的使用方式，加密可以分为两大类：**对称加密**和**非对称加密**



## 对称加密

指加密和解密时使用的是同一个密钥

- **对称加密算法**

  RC4、DES、3DES、AES、ChaCha20等，但前三种算法都被认为是不安全的通常都禁止使用，目前常用的只有**AES**和**ChaCha20**

  - **AES**

    高级加密标准，密钥长度可以是128、192或256，是DES算法的替代者，安全强度很高，性能也很好，是应用最广泛的对称加密算法

  - **ChaCha20**

    是Google设计的另一种加密算法，密钥长度固定为256位

- **加密分组模式**

  对称算法有一个**分组模式**的概念，可以让算法**用固定长度的密钥加密任意长度的明文**。最新的分组模式叫**AEAD**，在加密的同时**增加了认证的功能**，常用的是GCM、CCM和Poly1305

- **缺点**

  无法百分百保证密钥交换的安全性，即把密钥安全地传递给对方。如果密钥在传递过程中被黑客窃取，黑客就可以随意解密收发的数据，通信的过程没有机密性可言



## 非对称加密

又称公钥加密算法，有两个密钥，一个**公钥**，一个**私钥**，公钥可以公开给任何人使用，而私钥必须严格保密

- **单向性**

  公钥和私钥具有单向性，虽然都可以加密解密，但公钥加密后只能用私钥解密，私钥加密后只能用公钥解密

- **保证密钥交换的安全性**

  网站保管私钥，在网上任意分发公钥，用户登录网站使用公钥加密，密文只能由私钥持有者解密。黑客因为没有私钥，所以无法破解密文

- **非对称加密算法**

  非对称加密算法的设计比对称加密算法难很多，在TSL中只有很少的几种，比如DH、DSA、RSA、ECC等

  - **RSA**

    是**最著名**的一个，它的安全性基于**整数分解**的数学难题，使用两个超大素数的乘积作为生成密钥的材料，想要从公钥推算出私钥是非常困难的，密钥的推荐长度为**2048位以上**

  - **ECC**

    基于**椭圆曲线离散对数**的数学难题，使用特定的曲线方程和基点生成公钥和私钥，子算法 ECDHE 用于密钥交换，ECDSA 用于数字签名。160位的ECC相当于1024位的RSA，224位的ECC相当于2048位的RSA，因为密钥短，所以计算量、消耗的内存和宽带少，加密解密性能高

- **缺点**

  因为非对称加密算法都是基于复杂的数学难题，运算速度很慢，即使是 ECC 也要比 AES 差上好几个数量级。如果仅用非对称加密，虽然保证了安全，但通信速度极奇慢，实用性就非常低



## 混合加密

对称加密和非对称加密结合使用，是TLS中使用的加密方法

- **使用方法**

  1. 在通信刚开始时使用非对称算法，解决密钥交换问题
  2. 使用随机数产生对称算法使用的**会话密钥**，再用公钥加密
  3. 对方拿到密文后用私钥解密，取出会话密钥，双方实现对称密钥的安全交换，后续就不再使用非对称加密，全都使用对称加密

- **优点**

  解决了对称加密算法的密钥交换问题，且安全和性能兼顾，完美地实现了机密性