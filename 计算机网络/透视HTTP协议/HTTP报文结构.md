# HTTP报文结构

[TOC]

HTTP协议是一个**纯文本**的协议，头数据都是ASCII码的文本



## 基本结构

HTTP协议的请求报文和响应报文的结构基本相同，由三大部分组成：

- **起始行(start line)**：描述请求或响应的基本信息
- **头部字段集合(header)**：使用key-value形式更详细地说明报文
- **消息正文(entity/body)**：实际传输的数据，它不一定是纯文本，可以是图片、视频等二进制数据

其中前两部分起始行和头部字段经常合称为**请求头**或**响应头**，消息正文称为**实体**

*HTTP协议规定报文必须有header，但可以没有body，而且header后必须要有一个空行，也就是"CRLF"，十六进制的"0D0A"

*HTTP协议对header的大小没有限制，但各个Web服务器都不允许过大的请求头，因为头部过大可能会占用大量的服务器资源，影响运行效率



## 请求行

描述了客户端想要如何操作服务器端的资源

- **结构**

  - **请求方法**：如GET、POST
  - **请求目标**：通常是一个URI，标记了请求方法要操作的资源
  - **版本号**：表示报文使用的HTTP协议版本

  这三个部分通常使用空格来分隔，最后要用CRLF换行表示结束



## 状态行

响应报文里的起始行，指服务器响应的状态

- **结构**
  - **版本号**：表示报文使用的HTTP协议版本
  - **状态码**：表示服务器处理的结果
  - **原因**：作为数字状态码补充，是更详细的解释文字，帮助人理解原因



## 头部字段

HTTP头字段非常灵活，不仅可以使用标准里的Host、Connection等已有头，也可以任意添加自定义头，这就给HTTP协议带来了无限的扩展可能

- **注意事项**
  - 字段名不区分大小写，但首字母大写的可读性更好
  - 字段名里不允许出现空格，可以使用连字符，但不能使用下划线
  - 字段名后面必须紧接着":"，不能有空格，而":"后的字段值前可以有多个空格
  - 字段的顺序没有意义，可以任意排列不影响语义
  - 字段原则上不能重复，除非这个字段本身的语义允许



## 常用头字段

HTTP协议规定了非常多的头部字段，实现各种各样功能，但基本上可以分为四大类：

- **通用字段**：在请求头和响应头里都可以出现
- **请求字段**：仅能出现在请求头里，进一步说明请求信息或者额外的附加条件
- **响应字段**：仅能出现在响应头里，补充说明响应报文的信息
- **实体字段**：它实际上属于通用字段，但专门描述body的额外信息

*Host字段属于请求字段，只能出现在请求头里，它是唯一一个HTTP/1.1规范里要求必须出现的字段，Host字段告诉服务器这个请求应该由哪个主机来处理