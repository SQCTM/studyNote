# 变量、作用域与内存问题

[TOC]

## 变量

变量包含两种不同数据类型的值：

- **基本类型值**

  指**简单数据段**。即Undefined、Null、Boolean、Number、String类型。

  这5种基本数据类型是**按值访问**的，可以操作保存在变量中的实际值。

- **引用类型值**

  指**对象**。值**保存在内存中**，不能直接操作对象的内存空间

  *当复制保存着对象的某个变量时，操作的是对象的引用；但在为对象添加属性时，操作的是实际的对象。



### 变量的创建和赋值

1. **创建**

   1. 创建命名
   2. 创建作用范围（作用域）
   3. 将创建变量的过程提至函数最顶部

2. **赋值**

   - 若值是基本类型值，则值被保存在变量中
   - 若值是引用类型值，则值被保存在内存中，同时创建内存地址即引用，然后将引用保存到创建出来的变量中

   

*通常变量的创建和赋值用一条语句来完成，如：`var a = 1;`



### 变量的操作

- **属性和方法的增删**

  - 若是基本类型值，不会报错，但没有效果
  - 若是引用类型值，解析器根据变量中保存的地址，在内存中找到保存的对象，再对对象进行属性和方法的增删操作。

- **变量的修改**

  - 变量的修改即给变量重新赋值
  - 修改变量是先将原变量销毁，再重新创建赋值
  - 若是修改引用类型值的某个属性，则是解析器根据变量中保存的地址，在内存中找到保存的对象，再进行修改

- **复制变量值**

  - 若是基本类型值，两个变量完全**独立**，参与任何操作**互不影响**。
  - 若是引用类型值，复制的只是变量的地址，再赋值给另一变量，两个变量实际上将**引用同一个对象**。虽然两个变量相互独立，但改变其中一个变量就会影响另一个变量。

- **参数的传递**

  - 传参即把函数外部的值**复制**给给函数内部的参数，但所有函数的参数都是**按值传递的**

  - 解析器不关心函数参数的数据类型

  - 若传的参数是基本类型值，基本与复制类似，函数外部与内部变量相互独立互不影响

    ```javascript
    function addTen(num) {     
        num += 10;     
        return num; 
    } 
    var count = 20; 
    var result = addTen(count); 
    console.log(count);   //20，没有变化 
    console.log(result);  //30 
    ```

  - 若传的参数是引用类型值

    ```javascript
    function setName(obj) {     
        obj.name = "Nicholas";     
        obj = new Object();     
        obj.name = "Greg"; 
    } 
    var person = new Object(); 
    setName(person); 
    console.log(person.name);    //"Nicholas" 
    ```

    person.name的值并未修改，由此可以证明传参是**按值传递**，而不是按引用传递。当函数内部重写obj时，这个变量引用的就是一个**局部对象**了。而这个局部对象会在函数执行完毕后立即被销毁。



### 检测类型instanceof

- 是二元操作符

- instanceof主要用于检测引用类型；typeof无法精准检测引用类型，适合检测基本数据类型

- instanceof的用法

  ```javascript
  console.log(a instanceof Object);   // 变量a是Object吗？
  console.log(b instanceof Array);    // 变量b是Array吗？
  console.log(c instanceof RegExp);   //变量c是RegExp吗？
  ```

- 在检测一个引用类型值和**Object**构造函数时，返回值永远是**true**，因为**所有引用类型值都是Object的实例**

- 如果检测的是**基本类型值**，返回结果永远是**false**，因为基本类型不是对象



## 作用域





## 内存